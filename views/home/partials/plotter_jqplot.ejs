<script>
$(function() {

WEB_SOCKET_SWF_LOCATION = "/static/WebSocketMain.swf";
WEB_SOCKET_DEBUG = true;

// Socket.io specific code
          var socket = io.connect('http://localhost:1337/echo');

// Setup plot
var options = {
    title:'Default Date Axis',
    seriesColors:[
        '#ff811b', '#005796', '#ffbf17', '#46b535', //'#e93f80', '#bbe3ff',
         '#007333', '#ffe370', '#a6004f', '#a6004f',
        '#bde734', '#0094d8', '#ffbedd'],
        gridPadding: {top: 1},
        grid: {
        //background: '#ffffff',
        shadow:false, 
        borderWidth:1.0
    },
        seriesDefaults: {
                lineWidth: 2,
                autoscale: true,
                shadow: false,
                markerOptions:{
                        shadow: false, 
                        size: 4
                        }
        },
        axesDefaults:{
          pad: 0.2,
          useSeriesColor: true,
          autoscale: false
        }
};

// For formatting the plot data
var enumerate = function(l) {
    var res = [];
    for (var i=0; i<l.length; ++i)
        res.push([i, l[i]])
    return res;
};

// Initial plot data is a bunch of 0's
var d1 = [];
for (var i=0; i<3; i++)
    d1.push(0);

// Create the inital graph
var plot = $.jqplot('graph', [enumerate(d1)], options);

// Update the graph when we get new data from the server
socket.on('cpu_data', function(data) {
    var d = plot.series[0].data;
    
    var newdata = data.point;
    
    var dp = [];
    dp[0] = d.length; // Xaxis
    dp[1] = newdata;  // Yaxis
    plot.series[0].data.push(dp);
    
    plot.replot({resetAxes:true});
});

});
</script>